<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpendTracker PWA</title>
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #f3f4f6; }
        .card { background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="p-4">

    <div class="max-w-md mx-auto">
        <h1 class="text-2xl font-bold text-gray-800 mb-4">Monthly Spending</h1>
        
        <div class="card p-6 mb-6">
            <input id="item" type="text" placeholder="What did you buy?" class="w-full mb-3 p-2 border rounded">
            <input id="amount" type="number" placeholder="Amount ($)" class="w-full mb-3 p-2 border rounded">
            <button onclick="addExpense()" class="w-full bg-blue-600 text-white p-2 rounded font-bold hover:bg-blue-700">
                Add Expense
            </button>
        </div>

        <div class="card p-6">
            <h2 class="font-semibold mb-3 border-b pb-2">Recent Transactions</h2>
            <ul id="expenseList" class="space-y-2"></ul>
            <hr class="my-4">
            <button onclick="exportToCSV()" class="w-full bg-green-600 text-white p-2 rounded font-bold hover:bg-green-700">
                Export to Google Sheets (CSV)
            </button>
        </div>
    </div>

    <script>
        let expenses = JSON.parse(localStorage.getItem('expenses')) || [];

        function render() {
            const list = document.getElementById('expenseList');
            list.innerHTML = expenses.map((e, i) => `
                <li class="flex justify-between text-sm">
                    <span>${e.date} - ${e.item}</span>
                    <span class="font-bold">$${e.amount}</span>
                </li>
            `).join('');
            localStorage.setItem('expenses', JSON.stringify(expenses));
        }

        function addExpense() {
            const item = document.getElementById('item').value;
            const amount = document.getElementById('amount').value;
            if(!item || !amount) return alert("Fill it out!");

            expenses.push({
                item,
                amount: parseFloat(amount).toFixed(2),
                date: new Date().toLocaleDateString()
            });
            
            document.getElementById('item').value = '';
            document.getElementById('amount').value = '';
            render();
        }

        function exportToCSV() {
            if (expenses.length === 0) return alert("No data to export!");
            
            let csvContent = "data:text/csv;charset=utf-8,Date,Item,Amount\n" 
                + expenses.map(e => `${e.date},${e.item},${e.amount}`).join("\n");

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `spending_${new Date().getMonth() + 1}.csv`);
            document.body.appendChild(link);
            link.click();
        }

        render();
    </script>
</body>
</html>
